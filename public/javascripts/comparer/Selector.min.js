function SortedArray(){var v=0;this.array=[];for(var l=arguments.length;v<l;)this.insert(arguments[v++]);this.length=0;this.insert=function(b){var f=this.array,m=f.length;f.push(b);for(this.length=this.array.length;m;){b=m;var h=--m;if(f[b]<f[h]){var g=f[b];f[b]=f[h];f[h]=g}}return this};this.get=function(b){return this.array[b]};this.getArray=function(){return this.array};this.uniqueInsert=function(b){-1==this.search(b)&&this.insert(b)};this.search=function(b){for(var f=0,m=this.array,h=m.length;h>
f;){var g=(h+f)/2>>>0,l=m[g];if(l<b)f=g+1;else if(l>b)h=g;else return g}return-1};this.remove=function(b){b=this.search(b);0<=b&&this.array.splice(b,1);this.length=this.array.length;return this}}"undefined"===typeof exports&&(exports={});
var Selector=exports.Selector=function(v,l){function b(a,c,e,p,h){var g=document.createElement("ul");g.className=l["ul-class"];a.sort(function(a,c){return a.label<c.label?-1:a.label>c.label?1:0});for(var v=a.length,u=null,w=!1,x=[],y=0;y<v;y++){var n=a[y],r=n.children&&n.children.length?n.children.length:0,k=document.createElement("li");g.appendChild(k);k.code=n.code;k.liParent=c;k.data=n;k.isSelected=!1;var d=document.createElement("a");d.href="javascript: void(0)";d.value=n.label;-1!=l.selectedItems.indexOf(k.code)&&
(w=!0,x.push(d));d.previousSiblingLink=p;d.nextSiblingLink=null;d.parentLink=h;p&&(p.nextSiblingLink=d);0==y&&(u=d);d.className="circleAndText";k.appendChild(d);d.liParent=k;d.onclick=function(a){var c=this.liParent;m(c,l.callback,!c.isSelected);a&&a.stopPropagation()};var t=document.createElement("div");t.className=0<r?"plusOrMinus":"hidden-plusOrMinus";t.innerHTML="+";d.appendChild(t);0<r&&(t.onclick=function(a){f(this);a.stopPropagation()});d.plusOrMinus=t;d.onkeydown=function(a){if(13==a.keyCode){var c=
this.liParent;m(c,l.callback,!c.isSelected);a.stopPropagation();return!1}if(38==a.keyCode)return this.previousSiblingLink&&this.previousSiblingLink.focus(),a.stopPropagation(),!1;if(40==a.keyCode)return this.plusOrMinus.opened&&this.firstChildLink?this.firstChildLink.focus():this.nextSiblingLink?this.nextSiblingLink.focus():this.parentLink.nextSiblingLink&&this.parentLink.nextSiblingLink.focus(),a.stopPropagation(),!1;if(37==a.keyCode||39==a.keyCode)return a.stopPropagation(),f(this.plusOrMinus),
a.keyCode=9,a.keyCode};var q=document.createElement("div");q.className="circle";d.appendChild(q);p=document.createElement("div");p.className="title";d.appendChild(p);var s=document.createTextNode(n.label);p.appendChild(s);p=d;0<r&&(r=document.createElement("span"),r.className="empty-counter",q.appendChild(r),s=document.createTextNode("0"),r.appendChild(s),k.counter={div:r,value:0},q=b(n.children,k,e+1,p,d),k.appendChild(q.ul),d.firstChildLink=q.firstChildLink,t.childrenUl=q.ul,!0==q.selected&&(w=
!0,t.innerHTML="-"),x=x.concat(q.selectedItems));k.childNumber=n.children?n.children.length:0}1<e&&!1==w&&(g.style.display="none");return{ul:g,firstChildLink:u,selected:w,selectedItems:x}}function f(a){"+"==a.innerHTML?(a.innerHTML="&#8212;",a.childrenUl&&(a.childrenUl.style.display="block"),a.opened=!0):(a.innerHTML="+",a.childrenUl&&(a.childrenUl.style.display="none"),a.opened=!1)}function m(a,c,e){h(a,e);if(a.liParent){var b=a.liParent.counter.value,b=e?b+1:b-1;g(a.liParent,b);e?b==a.liParent.childNumber&&
(a.liParent.className="selected",a.liParent.isSelected=!0,s(a.liParent.code,!0)):(a.liParent.className="not-selected",a.liParent.isSelected=!1,s(a.liParent.code,!1))}0<a.childNumber&&g(a,e?a.childNumber:0);c&&c.call(a,a.data,z)}function h(a,c){"li"==a.tagName.toLowerCase()&&(a.isSelected=c,a.className=c?"selected":"not-selected",s(a.code,c),a.firstChild.title=a.firstChild.value+(c?" is selected":""));for(var e=a&&a.children&&a.children.length?a.children.length:0,b=0;b<e;b++)h(a.children[b],c)}function g(a,
c){var b=a.counter;b.value=c;b.div.innerHTML=b.value;b.div.className=0<b.value?"counter":"empty-counter";c=a.firstChild.value;a.firstChild.title=c+": "+b.value+(1!=b.value?" selected countries":" selected country")}function s(a,c){a&&(c?z.uniqueInsert(a):z.remove(a))}function A(a,c){if(c instanceof Array)return c;if("object"===typeof c){for(var b in c)a[b]=A(a[b],c[b]);return a}return c}var B={"ul-class":"default-selector",callback:null,selectedItems:[]},z=new SortedArray,u=null;(function(){var a=
l;if(a){"string"===typeof a&&(a={container:a});var c=JSON.parse(JSON.stringify(B)),e;for(e in a)c[e]=A(c[e],a[e]);a=c}else a=JSON.parse(JSON.stringify(B));l=a;a=b(v,null,1,null,null);u=a.ul;a=a.selectedItems;c=a.length;for(e=0;e<c;e++)a[e].onclick()})();this.render=function(){return u};this.clear=function(){for(var a=u.children.length,b=0;b<a;b++)m(u.children[b],null,!1)}};
